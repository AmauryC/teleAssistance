<!doctype html>
<!-- The DOCTYPE declaration above will set the     -->
<!-- browser's rendering engine into                -->
<!-- "Standards Mode". Replacing this declaration   -->
<!-- with a "Quirks Mode" doctype is not supported. -->

<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<!--                                                               -->
<!-- Consider inlining CSS to reduce the number of requested files -->
<!--                                                               -->
<link type="text/css" rel="stylesheet" href="SOAGamble2.css">

<!--                                           -->
<!-- Any title is fine                         -->
<!--                                           -->
<title>Web Application Starter Project</title>

<!--                                           -->
<!-- This script loads your compiled module.   -->
<!-- If you add any GWT meta tags, they must   -->
<!-- be added before this line.                -->
<!--                                           -->
<script type="text/javascript" language="javascript"
	src="soagamble2/soagamble2.nocache.js"></script>

<script>
	var assets = 1000.0;
	
	function printSportEventTable(events) {
		var eventTable = document.getElementById("eventTable");
		events.forEach(function(entry) {
	    	var tr = document.createElement("tr");
	    	var td = document.createElement("td");
	    	tr.appendChild(td);
	    	var text = document.createTextNode(entry);
			td.appendChild(text);
			eventTable.appendChild(tr);
		});
	}
	
	function printOdds(odds){

		var eventTable = document.getElementById("eventTable");
	
		for(var i=0; i<eventTable.rows.length;i++){
			if(eventTable.rows[i].cells.length==1){
				var td = document.createElement("td");
				var txt = document.createTextNode(odds[0]+" / "+odds[1]+" / "+odds[2]);
				td.appendChild(txt);
				eventTable.rows[i].appendChild(td);
				break;
			}
		
		}
	}
	
	function printBet(bet){
		if(bet!=undefined){
			var eventTable = document.getElementById("eventTable");
	
			for(var i=0; i<eventTable.rows.length;i++){
				if(eventTable.rows[i].cells.length==2){
					var td = document.createElement("td");
					var txt = document.createTextNode(bet[0]);
					td.appendChild(txt);
					eventTable.rows[i].appendChild(td);
					break;
				}
		
			}
		}
		
	}
	
	function printProfit(profit){
		var eventTable = document.getElementById("eventTable");
	
		for(var i=0; i<eventTable.rows.length;i++){
			if(eventTable.rows[i].cells.length==3){
				var td = document.createElement("td");
				var txt = document.createTextNode(profit[0]+"€");
				td.appendChild(txt);
				eventTable.rows[i].appendChild(td);
				break;
			}
		
		}
	}
	function displayProfit(profit){
		var div = document.getElementById("profits");
		var text = document.createTextNode("Your profits : "+profit+" €");
		div.appendChild(text);
		
		assets = assets+profit;
		computeAssets(0);
		
	}
	
	function initiateSequence(){
		document.getElementById("profits").innerHTML="";
		var table = document.getElementById("eventTable");
		for(var i = table.rows.length - 1; i > 0; i--)
		{
    		table.deleteRow(i);
		}
		launchWorkflow();
		
	}
	
	function computeAssets(paid){
		assets = assets-paid;
		console.log(assets, paid);
		var span = document.getElementById("assets");
		span.innerHTML="";
		var txt = document.createTextNode("Available : "+assets+"€");
		span.appendChild(txt);
	}
</script>
</head>

<!--                                           -->
<!-- The body can have arbitrary html, or      -->
<!-- you can leave the body empty if you want  -->
<!-- to create a completely dynamic UI.        -->
<!--                                           -->
<body>

	<!-- OPTIONAL: include this if you want history support -->
	<iframe src="javascript:''" id="__gwt_historyFrame" tabIndex='-1'
		style="position: absolute; width: 0; height: 0; border: 0"></iframe>

	<!-- RECOMMENDED if your web app will not function without JavaScript enabled -->
	<noscript>
		<div
			style="width: 22em; position: absolute; left: 50%; margin-left: -11em; color: red; background-color: white; border: 1px solid red; padding: 4px; font-family: sans-serif">
			Your web browser must have JavaScript enabled in order for this
			application to display correctly.</div>
	</noscript>
	<h1>Gambling SOA system</h1>
	<p>
		<span id="assets">Available : 1000.0€</span><br/>
		Click here to <a href="javascript:initiateSequence()">launch the automatic bet sequence</a>
	</p>

	<table id="eventTable">
		<tr>
			<th>
				Event
			</th>
			<th>
				Odds
			</th>
			<th>
				Bet
			</th>
			<th>
				Winnings
			</th>
		</tr>
	</table>
	<br/>
	<div id="profits">
	</div>
</body>
</html>
